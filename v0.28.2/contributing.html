<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Contributing - PyO3 user guide</title>


        <!-- Custom HTML head -->

        <meta name="description" content="PyO3 user guide">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon-de23e50b.svg">
        <link rel="shortcut icon" href="favicon-8114d1fc.png">
        <link rel="stylesheet" href="css/variables-8adf115d.css">
        <link rel="stylesheet" href="css/general-2459343d.css">
        <link rel="stylesheet" href="css/chrome-ae938929.css">
        <link rel="stylesheet" href="css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="theme/tabs-52f01167.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex-34530c57.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc-4c684194.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">PyO3 user guide</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>
                        <a href="https://github.com/PyO3/pyo3/tree/main/guide" title="Git repository" aria-label="Git repository">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span>
                        </a>
                        <a href="https://github.com/PyO3/pyo3/edit/main/guide/src/contributing.md" title="Suggest an edit" aria-label="Suggest an edit" rel="edit">
                            <span class=fa-svg id="git-edit-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M421.7 220.3l-11.3 11.3-22.6 22.6-205 205c-6.6 6.6-14.8 11.5-23.8 14.1L30.8 511c-8.4 2.5-17.5 .2-23.7-6.1S-1.5 489.7 1 481.2L38.7 353.1c2.6-9 7.5-17.2 14.1-23.8l205-205 22.6-22.6 11.3-11.3 33.9 33.9 62.1 62.1 33.9 33.9zM96 353.9l-9.3 9.3c-.9 .9-1.6 2.1-2 3.4l-25.3 86 86-25.3c1.3-.4 2.5-1.1 3.4-2l9.3-9.3H112c-8.8 0-16-7.2-16-16V353.9zM453.3 19.3l39.4 39.4c25 25 25 65.5 0 90.5l-14.5 14.5-22.6 22.6-11.3 11.3-33.9-33.9-62.1-62.1L314.3 67.7l11.3-11.3 22.6-22.6 14.5-14.5c25-25 65.5-25 90.5 0z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <h1 id="contributing"><a class="header" href="#contributing">Contributing</a></h1>
<p>Thank you for your interest in contributing to PyO3! All are welcome - please consider reading our <a href="https://github.com/PyO3/pyo3/blob/main/Code-of-Conduct.md">Code of Conduct</a> to keep our community positive and inclusive.</p>
<p>If you are searching for ideas how to contribute, proceed to the <a href="#getting-started-contributing">“Getting started contributing”</a> section. If you have found a specific issue to contribute to and need information about the development process, you may find the section <a href="#writing-pull-requests">“Writing pull requests”</a> helpful.</p>
<p>If you want to become familiar with the codebase, see
<a href="https://github.com/PyO3/pyo3/blob/main/Architecture.md">Architecture.md</a>.</p>
<h2 id="getting-started-contributing"><a class="header" href="#getting-started-contributing">Getting started contributing</a></h2>
<p>Please join in with any part of PyO3 which interests you. We use GitHub issues to record all bugs and ideas. Feel free to request an issue to be assigned to you if you want to work on it.</p>
<p>You can browse the API of the non-public parts of PyO3 <a href="https://pyo3.netlify.app/internal/doc/pyo3/index.html">here</a>.</p>
<p>The following sections also contain specific ideas on where to start contributing to PyO3.</p>
<h2 id="setting-up-a-development-environment"><a class="header" href="#setting-up-a-development-environment">Setting up a development environment</a></h2>
<p>To work and develop PyO3, you need Python &amp; Rust installed on your system.</p>
<ul>
<li>We encourage the use of <a href="https://rustup.rs/">rustup</a> to be able to select and choose specific toolchains based on the project.</li>
<li><a href="https://github.com/pyenv/pyenv">Pyenv</a> is also highly recommended for being able to choose a specific Python version.</li>
<li><a href="https://virtualenv.pypa.io/en/latest/">virtualenv</a> can also be used with or without Pyenv to use specific installed Python versions.</li>
<li><a href="https://github.com/theacodes/nox"><code>nox</code></a> is used to automate many of our CI tasks.</li>
</ul>
<h3 id="testing-linting-etc-with-nox"><a class="header" href="#testing-linting-etc-with-nox">Testing, linting, etc. with nox</a></h3>
<p><a href="https://github.com/theacodes/nox"><code>Nox</code></a> is used to automate many of our CI tasks and can be used locally to handle verification tasks as you code. We recommend running these actions via nox to make use of our preferred configuration options. You can install nox into your global python with pip: <code>pip install nox</code> or (recommended) with <a href="https://pipx.pypa.io/stable/"><code>pipx</code></a> <code>pip install pipx</code>, <code>pipx install nox</code></p>
<p>The main nox commands we have implemented are:</p>
<ul>
<li><code>nox -s test</code> will run the full suite of recommended rust and python tests (&gt;10 minutes)</li>
<li><code>nox -s test-rust -- skip-full</code> will run a short suite of rust tests (2-3 minutes)</li>
<li><code>nox -s ruff</code> will check python linting and apply standard formatting rules</li>
<li><code>nox -s rustfmt</code> will check basic rust linting and apply standard formatting rules</li>
<li><code>nox -s rumdl</code> will check the markdown in the guide</li>
<li><code>nox -s clippy</code> will run clippy to make recommendations on rust style</li>
<li><code>nox -s bench</code> will benchmark your rust code</li>
<li><code>nox -s codspeed</code> will run our suite of rust and python performance tests</li>
<li><code>nox -s coverage</code> will analyse test coverage and output <code>coverage.json</code> (alternatively: <code>nox -s coverage lcov</code> outputs <code>lcov.info</code>)</li>
<li><code>nox -s check-guide</code> will use <a href="https://github.com/lycheeverse/lychee"><code>lychee</code></a> to check all the links in the guide and doc comments.</li>
</ul>
<p>Use  <code>nox -l</code> to list the full set of subcommands you can run.</p>
<h4 id="ui-tests"><a class="header" href="#ui-tests">UI Tests</a></h4>
<p>PyO3 uses <a href="https://github.com/dtolnay/trybuild"><code>trybuild</code></a> to develop UI tests to capture error messages from the Rust compiler for some of the macro functionality.</p>
<p>The Rust compiler’s error output differs depending on whether the <code>rust-src</code> component is installed. PyO3’s CI has <code>rust-src</code> installed, so you need it locally for your UI test output to match:</p>
<pre><code class="language-bash">rustup component add rust-src
</code></pre>
<p>Because there are several feature combinations for these UI tests, when updating them all (e.g. for a new Rust compiler version) it may be helpful to use the <code>update-ui-tests</code> nox session:</p>
<pre><code class="language-bash">nox -s update-ui-tests
</code></pre>
<h2 id="ways-to-help"><a class="header" href="#ways-to-help">Ways to help</a></h2>
<h3 id="help-users-identify-bugs"><a class="header" href="#help-users-identify-bugs">Help users identify bugs</a></h3>
<p>The <a href="https://discord.gg/33kcChzH7f">PyO3 Discord server</a> is very active with users who are new to PyO3, and often completely new to Rust. Helping them debug is a great way to get experience with the PyO3 codebase.</p>
<p>Helping others often reveals bugs, documentation weaknesses, and missing APIs. It’s a good idea to open GitHub issues for these immediately so the resolution can be designed and implemented!</p>
<h3 id="implement-issues-ready-for-development"><a class="header" href="#implement-issues-ready-for-development">Implement issues ready for development</a></h3>
<p>Issues where the solution is clear and work is not in progress use the <a href="https://github.com/PyO3/pyo3/issues?q=is%3Aissue+is%3Aopen+label%3Aneeds-implementer">needs-implementer</a> label.</p>
<p>Don’t be afraid if the solution is not clear to you! The core PyO3 contributors will be happy to mentor you through any questions you have to help you write the solution.</p>
<h3 id="help-write-great-docs"><a class="header" href="#help-write-great-docs">Help write great docs</a></h3>
<p>PyO3 has a user guide (using mdbook) as well as the usual Rust API docs. The aim is for both of these to be detailed, easy to understand, and up-to-date. Pull requests are always welcome to fix typos, change wording, add examples, etc.</p>
<p>There are some specific areas of focus where help is currently needed for the documentation:</p>
<ul>
<li>Issues requesting documentation improvements are tracked with the <a href="https://github.com/PyO3/pyo3/issues?q=is%3Aissue+is%3Aopen+label%3Adocumentation">documentation</a> label.</li>
<li>Not all APIs had docs or examples when they were made. The goal is to have documentation on all PyO3 APIs (<a href="https://github.com/PyO3/pyo3/issues/306">#306</a>). If you see an API lacking a doc, please write one and open a PR!</li>
</ul>
<p>To build the docs (including all features), install <a href="https://github.com/theacodes/nox"><code>nox</code></a> and then run</p>
<pre><code class="language-shell">nox -s docs -- open
</code></pre>
<h4 id="doctests"><a class="header" href="#doctests">Doctests</a></h4>
<p>We use lots of code blocks in our docs. Run <code>cargo test --doc</code> when making changes to check that
the doctests still work, or <code>cargo test</code> to run all the Rust tests including doctests. See
https://doc.rust-lang.org/rustdoc/documentation-tests.html for a guide on doctests.</p>
<h4 id="building-the-guide"><a class="header" href="#building-the-guide">Building the guide</a></h4>
<p>You can preview the user guide by building it locally with <code>mdbook</code>.</p>
<p>First, install <a href="https://rust-lang.github.io/mdBook/cli/index.html"><code>mdbook</code></a>, the <a href="https://mdbook-plugins.rustforweb.org/tabs.html"><code>mdbook-tabs</code></a> plugin and <a href="https://github.com/theacodes/nox"><code>nox</code></a>. Then, run</p>
<pre><code class="language-shell">nox -s build-guide -- --open
</code></pre>
<p>To check all links in the guide are valid, also install <a href="https://github.com/lycheeverse/lychee"><code>lychee</code></a> and use the <code>check-guide</code> session instead:</p>
<pre><code class="language-shell">nox -s check-guide
</code></pre>
<h3 id="help-design-the-next-pyo3"><a class="header" href="#help-design-the-next-pyo3">Help design the next PyO3</a></h3>
<p>Issues which don’t yet have a clear solution use the <a href="https://github.com/PyO3/pyo3/issues?q=is%3Aissue+is%3Aopen+label%3Aneeds-design">needs-design</a> label.</p>
<p>If any of these issues interest you, please join in with the conversation on the issue! All opinions are valued, and if you’re interested in going further with e.g. draft PRs to experiment with API designs, even better!</p>
<h3 id="review-pull-requests"><a class="header" href="#review-pull-requests">Review pull requests</a></h3>
<p>Everybody is welcome to submit comments on open PRs. Please help ensure new PyO3 APIs are safe, performant, tidy, and easy to use!</p>
<h2 id="writing-pull-requests"><a class="header" href="#writing-pull-requests">Writing pull requests</a></h2>
<p>Here are a few things to note when you are writing PRs.</p>
<h3 id="testing-and-continuous-integration"><a class="header" href="#testing-and-continuous-integration">Testing and Continuous Integration</a></h3>
<p>The PyO3 repo uses GitHub Actions.
PRs are blocked from merging if CI is not successful.
Formatting, linting and tests are checked for all Rust and Python code (the pipeline will abort early if formatting fails to save resources).
In addition, all warnings in Rust code are disallowed (using <code>RUSTFLAGS="-D warnings"</code>).</p>
<p>Tests run with all supported Python versions with the latest stable Rust compiler, as well as for Python 3.9 with the minimum supported Rust version.</p>
<p>If you are adding a new feature, you should add it to the <code>full</code> feature in our <em>Cargo.toml</em>* so that it is tested in CI.</p>
<p>You can run the CI pipeline components yourself with <code>nox</code>, see <a href="#testing-linting-etc-with-nox">the testing section above</a>.</p>
<h3 id="documenting-changes"><a class="header" href="#documenting-changes">Documenting changes</a></h3>
<p>We use <a href="https://towncrier.readthedocs.io/en/stable/index.html">towncrier</a> to generate a CHANGELOG for each release.</p>
<p>To include your changes in the release notes, you should create one (or more) news items in the <code>newsfragments</code> directory. Valid news items should be saved as <code>&lt;PR&gt;.&lt;CATEGORY&gt;.md</code> where <code>&lt;PR&gt;</code> is the pull request number and <code>&lt;CATEGORY&gt;</code> is one of the following:</p>
<ul>
<li><code>packaging</code> - for dependency changes and Python / Rust version compatibility changes</li>
<li><code>added</code> - for new features</li>
<li><code>changed</code> - for features which already existed but have been altered or deprecated</li>
<li><code>removed</code> - for features which have been removed</li>
<li><code>fixed</code> - for “changed” features which were classed as a bugfix</li>
</ul>
<p>Docs-only PRs do not need news items; start your PR title with <code>docs:</code> to skip the check.</p>
<h3 id="style-guide"><a class="header" href="#style-guide">Style guide</a></h3>
<h4 id="generic-code"><a class="header" href="#generic-code">Generic code</a></h4>
<p>PyO3 has a lot of generic APIs to increase usability. These can come at the cost of generic code bloat. Where reasonable, try to implement a concrete sub-portion of generic functions. There are two forms of this:</p>
<ul>
<li>If the concrete sub-portion doesn’t benefit from re-use by other functions, name it <code>inner</code> and keep it as a local to the function.</li>
<li>If the concrete sub-portion is re-used by other functions, preferably name it <code>_foo</code> and place it directly below <code>foo</code> in the source code (where <code>foo</code> is the original generic function).</li>
</ul>
<h4 id="ffi-calls"><a class="header" href="#ffi-calls">FFI calls</a></h4>
<p>PyO3 makes a lot of FFI calls to Python’s C API using raw pointers. Where possible try to avoid using pointers-to-temporaries in expressions:</p>
<pre><code class="language-rust">// dangerous
pyo3::ffi::Something(name.to_object(py).as_ptr());

// because the following refactoring is a use-after-free error:
let name = name.to_object(py).as_ptr();
pyo3::ffi::Something(name)</code></pre>
<p>Instead, prefer to bind the safe owned <code>PyObject</code> wrapper before passing to ffi functions:</p>
<pre><code class="language-rust">let name: PyObject = name.to_object(py);
pyo3::ffi::Something(name.as_ptr())
// name will automatically be freed when it falls out of scope</code></pre>
<h2 id="python-and-rust-version-support-policy"><a class="header" href="#python-and-rust-version-support-policy">Python and Rust version support policy</a></h2>
<p>PyO3 aims to keep sufficient compatibility to make packaging Python extensions built with PyO3 feasible on most common package managers.</p>
<p>To keep package maintainers’ lives simpler, PyO3 will commit, wherever possible, to only adjust minimum supported Rust and Python versions at the same time. This bump will only come in an <code>0.x</code> release, roughly once per year, after the oldest supported Python version reaches its end-of-life. (Check https://endoflife.date/python for a clear timetable on these.)</p>
<p>Below are guidelines on what compatibility all PRs are expected to deliver for each language.</p>
<h3 id="python"><a class="header" href="#python">Python</a></h3>
<p>PyO3 supports all officially supported Python versions, as well as the latest PyPy3 release. All of these versions are tested in CI.</p>
<h4 id="adding-support-for-new-cpython-versions"><a class="header" href="#adding-support-for-new-cpython-versions">Adding support for new CPython versions</a></h4>
<p>If you plan to add support for a pre-release version of CPython, here’s a (non-exhaustive) checklist:</p>
<ul>
<li><input disabled="" type="checkbox"> Wait until the last alpha release (usually alpha7), since ABI is not guaranteed until the first beta release</li>
<li><input disabled="" type="checkbox"> Add prerelease_ver-dev (e.g. <code>3.14-dev</code>) to <code>.github/workflows/ci.yml</code>, and bump version in <code>noxfile.py</code>, <code>pyo3-ffi/Cargo.toml</code> under <code>max-version</code> within  <code>[package.metadata.cpython]</code>, and <code>max</code> within <code>pyo3-ffi/build.rs</code></li>
<li><input disabled="" type="checkbox"> Add a new abi3-prerelease feature for the version (e.g. <code>abi3-py314</code>)
<ul>
<li>In <code>pyo3-build-config/Cargo.toml</code>, set abi3-most_current_stable to [“abi3-prerelease”] and abi3-prerelease to [“abi3”]</li>
<li>In <code>pyo3-ffi/Cargo.toml</code>, set abi3-most_current_stable to [“abi3-prerelease”, “pyo3-build-config/abi3-most_current_stable”] and abi3-prerelease to [“abi3”, “pyo3-build-config/abi3-prerelease”]</li>
<li>In <code>Cargo.toml</code>, set abi3-most_current_stable to [“abi3-prerelease”, “pyo3-ffi/abi3-most_current_stable”] and abi3-prerelease to [“abi3”, “pyo3-ffi/abi3-prerelease”]</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Use <code>#[cfg(Py_prerelease])</code> (e.g. <code>#[cfg(Py_3_14)]</code>) and <code>#[cfg(not(Py_prerelease]))</code> to indicate changes between the stable branches of CPython and the pre-release</li>
<li><input disabled="" type="checkbox"> Do not add a Rust binding to any function, struct, or global variable prefixed with <code>_</code> in CPython’s headers</li>
<li><input disabled="" type="checkbox"> Ping @ngoldbaum and @davidhewitt for assistance</li>
</ul>
<h3 id="rust"><a class="header" href="#rust">Rust</a></h3>
<p>PyO3 aims to make use of up-to-date Rust language features to keep the implementation as efficient as possible.</p>
<p>The minimum Rust version supported will be decided when the release which bumps Python and Rust versions is made. At the time, the minimum Rust version will be set no higher than the lowest Rust version shipped in the current Debian, RHEL and Alpine Linux distributions.</p>
<p>CI tests both the most recent stable Rust version and the minimum supported Rust version. Because of Rust’s stability guarantees this is sufficient to confirm support for all Rust versions in between.</p>
<h2 id="benchmarking"><a class="header" href="#benchmarking">Benchmarking</a></h2>
<p>PyO3 has two sets of benchmarks for evaluating some aspects of its performance. The benchmark suite is currently very small - please open PRs with new benchmarks if you’re interested in helping to expand it!</p>
<p>First, there are Rust-based benchmarks located in the <code>pyo3-benches</code> subdirectory. You can run these benchmarks with:</p>
<pre><code>nox -s bench
</code></pre>
<p>Second, there is a Python-based benchmark contained in the <code>pytests</code> subdirectory. You can read more about it <a href="https://github.com/PyO3/pyo3/tree/main/pytests">here</a>.</p>
<h2 id="code-coverage"><a class="header" href="#code-coverage">Code coverage</a></h2>
<p>You can view what code is and isn’t covered by PyO3’s tests. We aim to have 100% coverage - please check coverage and add tests if you notice a lack of coverage!</p>
<ul>
<li>First, ensure the llvm-cov cargo plugin is installed. You may need to run the plugin through cargo once before using it with <code>nox</code>.</li>
</ul>
<pre><code class="language-shell">cargo install cargo-llvm-cov
cargo llvm-cov
</code></pre>
<ul>
<li>Then, generate an <code>lcov.info</code> file with</li>
</ul>
<pre><code class="language-shell">nox -s coverage -- lcov
</code></pre>
<p>You can install an IDE plugin to view the coverage. For example, if you use VSCode:</p>
<ul>
<li>Add the <a href="https://marketplace.visualstudio.com/items?itemName=ryanluker.vscode-coverage-gutters">coverage-gutters</a> plugin.</li>
<li>Add these settings to VSCode’s <code>settings.json</code>:</li>
</ul>
<pre><code class="language-json">{
    "coverage-gutters.coverageFileNames": [
        "lcov.info",
        "cov.xml",
        "coverage.xml",
    ],
    "coverage-gutters.showLineCoverage": true
}
</code></pre>
<ul>
<li>You should now be able to see green highlights for code that is tested, and red highlights for code that is not tested.</li>
</ul>
<h2 id="sponsor-this-project"><a class="header" href="#sponsor-this-project">Sponsor this project</a></h2>
<p>At the moment there is no official organisation that accepts sponsorship on PyO3’s behalf. If you’re seeking to provide significant funding to the PyO3 ecosystem, please reach out to us on <a href="https://github.com/PyO3/pyo3/issues/new">GitHub</a> or <a href="https://discord.gg/33kcChzH7f">Discord</a> and we can discuss.</p>
<p>In the meanwhile, some of our maintainers have personal GitHub sponsorship pages and would be grateful for your support:</p>
<ul>
<li><a href="https://github.com/sponsors/davidhewitt">davidhewitt</a></li>
<li><a href="https://github.com/sponsors/messense">messense</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="changelog.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="changelog.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                    </a>

            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr-ef4e11c1.min.js"></script>
        <script src="mark-09e88c2c.min.js"></script>
        <script src="searcher-c2a407aa.js"></script>

        <script src="clipboard-1626706a.min.js"></script>
        <script src="highlight-abc7f01d.js"></script>
        <script src="book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->
        <script src="theme/tabs-6977231d.js"></script>



    </div>
    </body>
</html>
